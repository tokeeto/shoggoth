#:kivy 2.0.0
#:import os os
#:import ui shoggoth.ui
#:import files shoggoth.files
#:import Factory kivy.factory.Factory

<AppMenuTextItem>:
    padding: [10, 0, 10, 0]

<Label>:
    markup: True

<TextInput>:
    write_tab: False
    font_size: '16dp'
    size_hint_y: None
    height: '32dp'
    multiline: False
    background_color: [1,1,1,1] if self.focus else [1, 1, 1, .8]

<BoxLayout>:
    spacing: '5dp'

<Button>:
    font_size: '16dp'
    size_hint_y: None
    height: '32dp'

<DropDownButton@Button>:
    size_hint_y: None
    height: '30dp'

<Thumbnail>:
    size_hint_y: None
    height: '300dp'
    on_release: app.goto_card(root.card_id)

<BoxContainer@GridLayout>:
    cols: 1
    size_hint_y: None
    height: self.minimum_height
    spacing: '5dp'

<TypeSelector>:
    title: 'Select Defaults'
    size_hint_y: .8
    size_hint_x: None
    width: '300dp'
    ScrollView:
        BoxLayout:
            height: self.minimum_height
            size_hint_y: None
            orientation: 'vertical'
            id: content_box

<WeaknessTypeSelector>:
    title: 'Select Variant'
    size_hint_y: .8
    size_hint_x: None
    width: '300dp'
    ScrollView:
        BoxLayout:
            height: self.minimum_height
            size_hint_y: None
            orientation: 'vertical'
            Button:
                text: 'Normal'
                on_release: root.select('')
            Button:
                text: 'Investigator Weakness'
                on_release: root.select('weakness')
            Button:
                text: 'Basic Weakness'
                on_release: root.select('basic_weakness')
            Button:
                text: 'Encounter Weakness'
                on_release: root.select('encounter_weakness')

<TemplateSelector>:
    title: 'Select Template'
    size_hint_y: .8
    size_hint_x: None
    width: '300dp'
    ScrollView:
        BoxLayout:
            height: self.minimum_height
            size_hint_y: None
            orientation: 'vertical'
            Label:
                size_hint_y: None
                height: '32dp'
                text: 'Investigator'
            Button:
                text: 'investigator'
                on_release: root.select(self.text)
            Button:
                text: 'asset'
                on_release: root.select(self.text)
            Button:
                text: 'event'
                on_release: root.select(self.text)
            Button:
                text: 'skill'
                on_release: root.select(self.text)
            Label:
                text: 'Weakness'
            Button:
                text: 'Enemy weakness'
                on_release: root.select('enemy_weakness')
            Button:
                text: 'Treachery weakness'
                on_release: root.select('treachery_weakness')
            Button:
                text: 'skill'
                on_release: root.select(self.text)
            Label:
                text: 'Story'
            Button:
                text: 'story'
                on_release: root.select(self.text)
            Button:
                text: 'treachery'
                on_release: root.select(self.text)
            Button:
                text: 'enemy'
                on_release: root.select(self.text)
            Button:
                text: 'location'
                on_release: root.select(self.text)
            Button:
                text: 'act'
                on_release: root.select(self.text)
            Button:
                text: 'agenda'
                on_release: root.select(self.text)
            Button:
                text: 'scenario'
                on_release: root.select(self.text)

<SetSelector>:
    title: 'Select Encounter Set'
    size_hint: .4,.4
    ScrollView:
        BoxLayout:
            height: self.minimum_height
            size_hint_y: None
            orientation: 'vertical'
            id: option_container

<ClassSelector>:
    DropDownButton:
        text: 'guardian'
        on_release: root.select_value(self.text)
    DropDownButton:
        text: 'seeker'
        on_release: root.select_value(self.text)
    DropDownButton:
        text: 'rogue'
        on_release: root.select_value(self.text)
    DropDownButton:
        text: 'survivor'
        on_release: root.select_value(self.text)
    DropDownButton:
        text: 'mystic'
        on_release: root.select_value(self.text)

<StrangeEonsImporter@Popup>:
    size_hint: .6, .3
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            orientation: 'horizontal'
            Label:
                text: 'SE Project'
            TextInput:
                size_hint_x: 0.6
                id: se_path
                size_hint_y: None
            Button:
                size_hint_x: 0.2
                text: 'Browse'
                on_release: ui.browse_folder(target=se_path)
        BoxLayout:
            orientation: 'horizontal'
            Label:
                text: 'Output'
            TextInput:
                size_hint_x: 0.6
                id: new_path
                size_hint_y: None
            Button:
                size_hint_x: 0.2
                text: 'Browse'
                on_release: ui.browse_folder(target=new_path)
        Label:
            text: "Once it starts, it will take a while (~30 seconds) with no response. Then Shoggoth will close. Then the new project file will be available in the output folder. This is expected for now."
        BoxLayout:
            orientation: 'horizontal'
            Button:
                text: 'Cancel'
                on_release: root.dismiss()
            Button:
                text: 'Convert'
                on_release: root.submit()

<CardPreview>:
    padding: '10dp'
    TabbedPanel:
        background_color: 0,0,0,0
        do_default_tab: False

        TabbedPanelItem:
            text: 'Front'
            RelativeLayout:
                Zoom:
                    Image:
                        id: front_preview
                        color: [1,1,1,0] if not self.texture else [1,1,1,1]

        TabbedPanelItem:
            text: 'Back'
            RelativeLayout:
                Zoom:
                    Image:
                        id: back_preview
                        color: [1,1,1,0] if not self.texture else [1,1,1,1]

<AboutPopup@Popup>:
    title: 'About Shoggoth'
    size_hint: 0.5, 0.5

    Label:
        text: ui.about_text
        text_size: self.width, None
        size: self.texture_size
        markup: True
        on_ref_press: ui.goto_ref(args)

<NewProjectPopup@Popup>:
    title: 'New Project'
    size_hint: 0.5, 0.5
    file_name: file_name

    BoxLayout:
        orientation: 'vertical'

        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            height: '32dp'

            Label:
                size_hint_x: 0.2
                text: 'abbreviation'
            TextInput:
                size_hint_x: 0.8
                id: code

        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            height: '32dp'
            Label:
                size_hint_x: 0.2
                text: 'name'
            TextInput:
                size_hint_x: 0.8
                id: name

        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            height: '32dp'
            Label:
                size_hint_x: 0.2
                text: 'Icon'
            TextInput:
                size_hint_x: 0.6
                id: icon
                value: ''
                disabled: True
            Button:
                size_hint_x: 0.2
                text: 'Select icon'
                on_release: ui.browse_image(icon)

        BoxLayout:
            orientation: "horizontal"
            size_hint_y: None
            height: '32dp'
            Label:
                size_hint_x: 0.2
                text: 'File name'
            TextInput:
                size_hint_x: 0.6
                id: file_name
                size_hint_y: None
                disabled: True
            Button:
                size_hint_x: 0.2
                text: 'Browse'
                on_release: ui.save_project_file(file_name, name.text)

        BoxLayout:
            size_hint_y: None
            height: '48dp'

            Button:
                text: 'Cancel'
                on_release: root.dismiss()

            Button:
                text: 'Create'
                on_release: root.save()

<GotoEntryListItem>:
    orientation: 'horizontal'
    size_hint_y: None
    height: '32dp'
    size_hint_x: 1
    on_release: root.callback(root.entry)
    Label:
        text: root.entry.name
    Label:
        text: root.entry.type
    Label:
        text: root.entry.id

<ExportPopup@Popup>:
    BoxLayout:
        orientation: 'vertical'
        ToggleButton:
            pressed: self.state == 'down'
            text: 'Including bleed' if self.pressed else 'Excluding bleed'
            id: bleed
        ToggleButton:
            pressed: self.state == 'down'
            text: 'Including common backs' if self.pressed else 'Excluding common backs'
            id: backs
        BoxLayout:
            orientation: 'horizontal'
            Label:
                text: 'Image format (we support most types, try "webp"):'
            TextInput:
                id: format
        BoxLayout:
            orientation: 'horizontal'
            Label:
                text: 'Image quality (50-100, 100 being lossless):'
            TextInput:
                id: quality
        BoxLayout:
            orientation: 'horizontal'
            Button:
                text: 'Cancel'
                on_release: root.dismiss()
            Button:
                text: 'Export'
                on_release: app.export_all(include_backs=backs.pressed, bleed=bleed.pressed, format=format.text, quality=int(quality.text))

<GotoPopup@Popup>:
    title: 'Go to line'
    size_hint: None, None
    size: '700dp', '700dp'
    BoxLayout:
        orientation: 'vertical'
        TextInput:
            id: input
            hint_text: 'Card name'
            size_hint_y: None
            height: '32dp'
        ScrollView:
            size_hint: 1, 1
            BoxLayout:
                orientation: 'vertical'
                id: list
                size_hint_y: None
                height: self.minimum_height

<TreeViewLabel>:
    full_path: ''
    color: .95, .95, .95, 1
    font_size: '14dp'

<TreeViewButton>:
    background_color: 0,0,0,0
    even_color: 1,1,1,.1
    color_selected: 1,1,1,.7
    color: [0,0,0,1] if self.is_selected else [.85,.9,.85,1]

<TopMenu@AppMenu>:
    top: root.parent.height
    cancel_handler_widget: root.parent
    AppMenuTextItem:
        text: 'File'
        ContextMenu:
            width: '200dp'
            ContextMenuTextItem:
                text: 'Open Project'
                on_release: app.open_project_dialog()
            ContextMenuTextItem:
                text: 'New Project'
                on_release: ui.NewProjectPopup().open()
            ContextMenuTextItem:
                text: 'Save (Ctrl+S)'
                on_release: app.save_changes()
                disabled: not app.current_project
            ContextMenuTextItem:
                text: 'New Card (Ctrl+N)'
                on_release: app.open_new_card_dialog()
                disabled: not app.current_project
            ContextMenuTextItem:
                text: 'Gather images'
                disabled: not app.current_project
                on_release: app.gather_images()
            ContextMenuTextItem:
                text: 'Gather images and update'
                disabled: not app.current_project
                on_release: app.gather_images(update=True)
            ContextMenuTextItem:
                text: 'Export Current Card (Ctrl+E)'
                disabled: not app.current_card
                on_release: app.export_current(bleed=True, format='png', quality=100)
            ContextMenuTextItem:
                text: 'Export All Cards (Ctrl+Shift+E)'
                disabled: not app.current_project
                on_release: ui.ExportPopup().open()
            ContextMenuDivider:
            ContextMenuTextItem:
                text: 'Settings'
                on_release: app.open_settings()
            ContextMenuDivider:
            ContextMenuTextItem:
                text: 'Exit'
                on_release: app.stop()
    AppMenuTextItem:
        text: 'Project: ' + (app.current_project.get('name') if app.current_project else 'None')
        disabled: not app.current_project
        ContextMenu:
            ContextMenuTextItem:
                text: 'Add Guide'
                on_release: app.current_project.add_guide()
            ContextMenuTextItem:
                text: 'Add Scenario template'
                on_release: app.current_project.create_scenario('Placeholder')
            ContextMenuTextItem:
                text: 'Add Campaign template'
                on_release: app.current_project.create_campaign()
            ContextMenuTextItem:
                text: 'Add Investigator template'
                on_release: app.current_project.add_investigator_set('John Doe')
            ContextMenuTextItem:
                text: 'Add Investigator Expansion template'
                on_release: app.current_project.create_player_expansion()
    AppMenuTextItem:
        text: "Tools"
        ContextMenu:
            ContextMenuTextItem:
                text: 'Convert SE Project'
                on_release: ui.StrangeEonsImporter().open()
            ContextMenuTextItem:
                text: 'Export card to TTS object'
                disabled: not app.current_project
                on_release: app.export_card_to_tts()
            ContextMenuTextItem:
                text: 'Export all campaign cards to TTS object'
                disabled: not app.current_project
                on_release: app.export_campaign_to_tts()
            ContextMenuTextItem:
                text: 'Export all player cards to TTS object'
                disabled: not app.current_project
                on_release: app.export_player_to_tts()
    AppMenuTextItem:
        text: 'Help'
        ContextMenu:
            width: '200dp'
            ContextMenuTextItem:
                text: 'Text options'
                on_release: ui.OkPopup(text=app.card_renderer.rich_text.get_help_text()).open()
            ContextMenuTextItem:
                text: 'About'
                on_release: ui.AboutPopup().open()

<ShoggothRoot>:
    canvas:
        Rectangle:
            source: root.bg_path
            size: self.size
            pos: self.pos

    BoxLayout:
        orientation: 'horizontal'
        size_hint: 1,1
        padding: [0,'26dp',0,'24dp']

        # File Browser Panel (left)
        Splitter:
            sizable_from: 'right'
            size_hint_x: None
            width: 350

            FileBrowser:
                id: file_browser

        # Editor Panel (middle)
        BoxLayout:
            id: editor_container
            padding: ['5dp','10dp']

        # Card Preview Panel (right)
        Splitter:
            sizable_from: 'left'
            size_hint_x: None
            min_size: 400

            CardPreview:
                id: card_preview
    TopMenu:
        id: top_menu
        size_hint: 1, None

    # Status bar
    Label:
        pos_hint: {'x': 0, 'bottom': 1}
        size_hint: 1, None
        id: status_bar
        text: app.status_message
        size_hint_y: None
        height: '24dp'
        text_size: self.size
        halign: 'left'
        padding: '10dp', 0
        canvas.before:
            Color:
                rgba: 0,0,0,.3
            Rectangle:
                size: self.size
                pos: self.pos

<FileBrowser>:
    tree: tree
    orientation: 'vertical'
    canvas:
        Color:
            rgba: 1,1,1,0
        Rectangle:
            source: None
            size: self.size
            pos: self.pos
        Color:
            rgba: 1,1,1,1

    Label:
        text: 'Cards'
        size_hint_y: None
        padding_top: '10dp'
        height: '50dp'
        font_size: '20dp'
        bold: True
        font_name: str(files.font_dir / 'Arkhamic.ttf')

    Label:
        text: 'Create a project\nto get started!'
        visible: app.current_project is None
        size_hint_y: None
        height: 100 if self.visible else 0
        font_size: '30dp'
        multiline: True
        bold: True
        opacity: .6 if self.visible else 0

    ScrollView:
        do_scroll_x: False
        visible: app.current_project is not None
        opacity: 1 if self.visible else 0

        TreeView:
            id: tree
            hide_root: True
            size_hint_y: None
            height: self.minimum_height
            on_selected_node: root.on_selected_node()


<FileField@BoxLayout>:
    orientation: 'horizontal'
    text: ''
    path: ''
    size_hint_y: None
    height: 30

    Label:
        size_hint_x: None
        width: 100
        text: root.text
    TextInput:
        text: root.path
        id: file_path
    Button:
        size_hint_x: None
        width: '70dp'
        text: 'Browse'
        on_press: ui.browse_image(target=file_path)

<NewEncounterPopup>:
    size_hint: .4,.4
    title: 'Add new Encounter Set'
    name: name
    error: error
    on_open: name.focus = True
    BoxLayout:
        orientation: 'vertical'
        TextInput:
            id: name
            multiline: False
            on_text_validate: root.create()
        Label:
            id: error
            text: ''
            size_hint_y: None
            height: '0dp'
            on_text: self.height = '28dp'
        Button:
            text: 'Create'
            on_release: root.create()

<OkPopup>:
    title: 'ERROR'
    size_hint: .4, .6
    BoxLayout:
        orientation: 'vertical'
        ScrollView:
            Label:
                size_hint_y: None
                text: root.text
                text_size: self.width, None
                size: self.texture_size
                markup: True
        Button:
            text: 'Ok'
            size_hint: None, None
            size: '100dp', '28dp'
            on_release: root.dismiss()

<NewCardPopup>:
    title: 'Add new card'
    name: name
    error: error
    size_hint: .75, None
    height: '250dp'
    on_open: name.focus = True
    selected_template: 'asset'
    selected_collection: None
    BoxLayout:
        orientation: 'vertical'

        # Single card
        BoxLayout:
            orientation: 'vertical'
            size_hint: 1,1
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: '28dp'
                Label:
                    text: 'Name'
                TextInput:
                    id: name
                    on_text_validate: root.create()
            Label:
                id: error
                text: ""
                size_hint_y: None
                height: '28dp'
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: '28dp'
                Label:
                    text: 'Template'
                Label:
                    text: 'asset'
                    id: template
                Button:
                    text: 'Select Template'
                    on_release: ui.TemplateSelector(callback=root.set_template).open()
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: '28dp'
                Label:
                    text: 'Set'
                Label:
                    text: 'Player card'
                    id: set_text
                Button:
                    text: 'Select Set'
                    on_release: ui.SetSelector(callback=root.set_encounter_set).open()
            Button:
                size_hint_y: None
                height: '28dp'
                text: 'Create'
                on_release: root.create()

<GuideEditor>:
    orientation: 'vertical'
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        height: 32
        FileField:
            text: 'Front page image'
            path: root.guide.front_page
            id: front_page_fields
    ScrollView:
        CodeInput:
            id: code_input
            size_hint_y: None
            height: self.minimum_height
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        height: 32
        Button:
            text: 'Export'
            on_release: root.export()
        Button:
            text: 'Show page'
            on_release: root.get_page(int(page_count.text))
        TextInput:
            value: '1'
            id: page_count
            on_text: root.get_page(int(self.text)) if self.text else root.get_page(0)

<ProjectEditor>:
    orientation: 'vertical'
    TextEditLine:
        size_hint_y: None
        text: 'Name'
        field: root.project.get('name', '')
    FileField:
        size_hint_y: None
        text: 'Icon'
        path: root.project.get('icon', '')
    Button:
        size_hint_y: None
        text: 'Add Encounter set'
        on_release: root.show_new_encounter_popup()
    ScrollView:
        size_hint: 1, 1
        GridLayout:
            size_hint_y: None
            height: self.minimum_height
            cols: 3
            id: thumbnail_grid

<EncounterEditor>:
    orientation: 'vertical'
    TextEditLine:
        text: 'Name'
        id: name
    TextEditLine:
        text: 'Order'
        id: order
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        height: '32dp'
        TextEditLine:
            text: 'Icon'
            id: icon
        Button:
            text: 'Browse'
            on_release: ui.browse_image(icon.input)
    Button:
        text: 'Delete set'
    ScrollView:
        size_hint: 1, 1
        GridLayout:
            size_hint_y: None
            height: self.minimum_height
            cols: 3
            id: thumbnail_grid

<CardEditor>:
    front_editor_container: front_editor_container
    back_editor_container: back_editor_container
    orientation: 'vertical'
    padding: '10dp'
    size_hint: 1, 1

    ScrollView:
        size_hint: 1, 1
        bar_width: 4
        GridLayout:
            cols: 1
            size_hint_y: None
            height: self.minimum_height
            padding: '5dp'
            spacing: '5dp'
            Label:
                text: 'Basic'
                font_size: '40dp'
                height: '50dp'
                size_hint_y: None
                align: 'center'
                font_name: str(files.font_dir / 'Arkhamic.ttf')
            TextEditLine:
                text: 'Name'
                id: name
            TextEditLine:
                text: 'Copyright'
                id: copyright
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: None
                height: self.minimum_height
                TextEditLine:
                    text: 'Amount in set'
                    id: amount
                TextEditLine:
                    text: 'Collection #'
                    id: collection_number
                TextEditLine:
                    text: 'Encounter Set #'
                    id: encounter_number
            TextEditLine:
                text: 'Investigator Link'
                id: collection
            TextEditLine:
                text: 'ID'
                id: card_id
            Label:
                text: 'Front'
                font_size: '40dp'
                height: '50dp'
                size_hint_y: None
                align: 'center'
                font_name: str(files.font_dir / 'Arkhamic.ttf')
            BoxContainer:
                id: front_editor_container
            Label:
                text: 'Back'
                font_size: '40dp'
                height: '50dp'
                size_hint_y: None
                align: 'center'
                font_name: str(files.font_dir / 'Arkhamic.ttf')
            BoxContainer:
                id: back_editor_container

<IllustrationSet@BoxLayout>:
    orientation: 'vertical'
    size_hint_y: None
    height: self.minimum_height
    spacing: 5
    padding: 0
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        height: self.minimum_height
        TextEditLine:
            text: 'Image Path'
            id: path
        Button:
            size_hint_x: None
            width: '100dp'
            text: 'Browse'
            on_release: ui.browse_image(path.input)
    BoxLayout:
        orientation: "horizontal"
        size_hint_y: None
        height: self.minimum_height
        TextEditLine:
            text: 'Pan Y'
            id: pan_y
        TextEditLine:
            text: 'Pan X'
            id: pan_x
        TextEditLine:
            text: 'Scale'
            id: scale
    BoxLayout:
        orientation: "horizontal"
        size_hint_y: None
        height: self.minimum_height
        TextEditLine:
            text: 'Artist'
            id: artist

<TextEditLine@BoxLayout>:
    input: input
    text: ''
    orientation: 'horizontal'
    size_hint_y: None
    height: '30dp'
    Label:
        size_hint_x: None
        width: '110dp'
        text: root.text
        halign: 'left'
        valign: 'middle'
        text_size: self.size
    TextInput:
        id: input
        text: ''


<TextEditArea@BoxLayout>:
    orientation: 'horizontal'
    input: input
    text: ''
    size_hint_y: None
    height: '140dp'
    Label:
        size_hint_x: None
        width: '110dp'
        text: root.text
        halign: 'left'
        valign: 'middle'
        text_size: self.size
    TextInput:
        id: input
        text: ''
        multiline: True
        size_hint_y: None
        height: '140dp'

<LevelInput@BoxLayout>:
    input: input
    orientation: 'horizontal'
    size_hint_y: None
    height: '32dp'
    Label:
        text: 'Level'
    Spinner:
        id: input
        size_hint_y: None
        height: '32dp'
        text: '0'
        values: ['None', '0', '1', '2', '3', '4', '5', 'Custom']

<FaceEditor@BoxContainer>:

<BaseEditor@FaceEditor>:
    BoxLayout:
        id: layout
        orientation: 'vertical'
        spacing: '5dp'
        size_hint_y: None
        height: self.minimum_height

        TextEditLine:
            text: 'Type'
            id: type
            Button:
                text: 'Select type'
                on_release: ui.TypeSelector(target=type.input).open()

<AssetEditor@BoxContainer>:
    TextEditLine:
        text: 'Type'
        id: type
    TextEditLine:
        text: 'Name'
        id: name
    TextEditLine:
        text: 'Subtitle'
        id: subtitle

    GridLayout:
        cols: 2
        size_hint_y: None
        height: self.minimum_height
        spacing: '5dp'

        TextEditLine:
            text: 'Traits'
            id: traits
        TextEditLine:
            text: 'Class'
            id: classes
        TextEditLine:
            text: 'Cost'
            id: cost
        LevelInput:
            id: level
        TextEditLine:
            text: 'Icons'
            id: icons
        TextEditLine:
            text: 'Health'
            id: health
        TextEditLine:
            text: 'Sanity'
            id: sanity
        TextEditLine:
            text: 'Slots'
            id: slots
    TextEditArea:
        text: 'Text'
        id: text
    TextEditArea:
        text: 'Flavor'
        id: flavor_text
    IllustrationSet:
        id: illustration

<EventEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'subtitle'
        id: subtitle

    GridLayout:
        cols: 2
        size_hint_y: None
        height: self.minimum_height
        spacing: '5dp'

        TextEditLine:
            text: 'Traits'
            id: traits
        TextEditLine:
            text: 'Class'
            id: classes
        TextEditLine:
            text: 'Cost'
            id: cost
        LevelInput:
            id: level
        TextEditLine:
            text: 'Icons'
            id: icons
    TextEditArea:
        text: 'Text'
        id: text
    TextEditArea:
        text: 'Flavor text'
        id: flavor_text
    IllustrationSet:
        id: illustration

<SkillEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'subtitle'
        id: subtitle

    GridLayout:
        cols: 2
        size_hint_y: None
        height: self.minimum_height
        spacing: '5dp'

        TextEditLine:
            text: 'traits'
            id: traits
        TextEditLine:
            text: 'Class'
            id: classes
        LevelInput:
            id: level
        TextEditLine:
            text: 'Icons'
            id: icons
    TextEditArea:
        text: 'text'
        id: text
    TextEditArea:
        text: 'flavor_text'
        id: flavor_text
    IllustrationSet:
        id: illustration

<InvestigatorEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'subtitle'
        id: subtitle

    GridLayout:
        cols: 2
        size_hint_y: None
        height: self.minimum_height
        spacing: '5dp'

        TextEditLine:
            text: 'Traits'
            id: traits
        TextEditLine:
            text: 'Class'
            id: classes
    TextEditArea:
        text: 'text'
        id: text
    TextEditArea:
        text: 'flavor_text'
        id: flavor_text

    GridLayout:
        cols: 4
        size_hint_y: None
        height: self.minimum_height
        spacing: '5dp'

        TextEditLine:
            text: 'willpower'
            id: willpower
        TextEditLine:
            text: 'intellect'
            id: intellect
        TextEditLine:
            text: 'combat'
            id: combat
        TextEditLine:
            text: 'agility'
            id: agility

    TextEditLine:
        text: 'health'
        id: health
    TextEditLine:
        text: 'sanity'
        id: sanity

    IllustrationSet:
        id: illustration

<InvestigatorBackEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'subtitle'
        id: subtitle

    GridLayout:
        cols: 2
        size_hint_y: None
        height: self.minimum_height
        spacing: '5dp'

        TextEditLine:
            text: 'traits'
            id: traits
        TextEditLine:
            text: 'Class'
            id: classes
    TextEditLine:
        text: 'Heading'
        id: heading1
    TextEditArea:
        text: 'Text'
        id: text1
    TextEditLine:
        text: 'Heading'
        id: heading2
    TextEditArea:
        text: 'Text'
        id: text2
    TextEditLine:
        text: 'Heading'
        id: heading3
    TextEditArea:
        text: 'Text'
        id: text3
    TextEditLine:
        text: 'Heading'
        id: heading4
    TextEditArea:
        text: 'Text'
        id: text4
    TextEditLine:
        text: 'Heading'
        id: heading5
    TextEditArea:
        text: 'Text'
        id: text5
    TextEditLine:
        text: 'Heading'
        id: heading6
    TextEditArea:
        text: 'Text'
        id: text6
    TextEditArea:
        text: 'flavor_text'
        id: flavor_text
    IllustrationSet:
        id: illustration

<LocationEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'subtitle'
        id: subtitle

    GridLayout:
        cols: 2
        size_hint_y: None
        height: self.minimum_height
        spacing: '5dp'

        TextEditLine:
            text: 'traits'
            id: traits
        TextEditLine:
            text: 'connection'
            id: connection
        TextEditLine:
            text: 'connections'
            id: connections
        TextEditLine:
            text: 'shroud'
            id: shroud
        TextEditLine:
            text: 'clues'
            id: clues
        TextEditLine:
            text: 'Victory'
            id: victory
    TextEditArea:
        text: 'text'
        id: text
    TextEditArea:
        text: 'flavor_text'
        id: flavor_text
    IllustrationSet:
        id: illustration

<LocationBackEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'subtitle'
        id: subtitle

    GridLayout:
        cols: 2
        size_hint_y: None
        height: self.minimum_height
        spacing: '5dp'

        TextEditLine:
            text: 'traits'
            id: traits
        TextEditLine:
            text: 'connection'
            id: connection
        TextEditLine:
            text: 'connections'
            id: connections
    TextEditArea:
        text: 'text'
        id: text
    TextEditArea:
        text: 'flavor_text'
        id: flavor_text
    IllustrationSet:
        id: illustration

<EnemyEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'subtitle'
        id: subtitle
    TextEditLine:
        text: 'Class'
        id: classes
        Button:
            text: 'Variants'
            on_release: ui.WeaknessTypeSelector(callback=ui.set_target(classes.input)).open()

    GridLayout:
        cols: 2
        size_hint_y: None
        height: self.minimum_height
        spacing: '5dp'

        TextEditLine:
            text: 'traits'
            id: traits
        TextEditLine:
            text: 'attack'
            id: attack
        TextEditLine:
            text: 'health'
            id: health
        TextEditLine:
            text: 'evade'
            id: evade
        TextEditLine:
            text: 'damage'
            id: damage
        TextEditLine:
            text: 'horror'
            id: horror
        TextEditLine:
            text: 'Victory'
            id: victory
    TextEditArea:
        text: 'text'
        id: text
    TextEditArea:
        text: 'flavor_text'
        id: flavor_text
    IllustrationSet:
        id: illustration

<TreacheryEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'subtitle'
        id: subtitle
    TextEditLine:
        text: 'Class'
        id: classes
        Button:
            text: 'Variants'
            on_release: ui.WeaknessTypeSelector(callback=ui.set_target(classes.input)).open()

    GridLayout:
        cols: 2
        size_hint_y: None
        height: self.minimum_height
        spacing: '5dp'

        TextEditLine:
            text: 'traits'
            id: traits
        TextEditLine:
            text: 'Victory'
            id: victory
    TextEditArea:
        text: 'text'
        id: text
    TextEditArea:
        text: 'flavor_text'
        id: flavor_text
    IllustrationSet:
        id: illustration

<ActEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'index'
        id: index
    TextEditLine:
        text: 'Clues'
        id: clues
    TextEditArea:
        text: 'Story'
        id: flavor_text
    TextEditArea:
        text: 'Text'
        id: text
    IllustrationSet:
        id: illustration

<ActBackEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'index'
        id: index
    TextEditArea:
        text: 'Story'
        id: flavor_text
    TextEditArea:
        text: 'Text'
        id: text

<AgendaEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'index'
        id: index
    TextEditLine:
        text: 'doom'
        id: doom
    TextEditArea:
        text: 'Story'
        id: flavor_text
    TextEditArea:
        text: 'Text'
        id: text
    IllustrationSet:
        id: illustration

<AgendaBackEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'index'
        id: index
    TextEditArea:
        text: 'Story'
        id: flavor_text
    TextEditArea:
        text: 'Text'
        id: text

<ChaosEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'difficulty'
        id: difficulty
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Token'
            id: token1
        TextEditLine:
            text: 'Text'
            id: text1
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Token'
            id: token2
        TextEditLine:
            text: 'Text'
            id: text2
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Token'
            id: token3
        TextEditLine:
            text: 'Text'
            id: text3
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Token'
            id: token4
        TextEditLine:
            text: 'Text'
            id: text4
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Token'
            id: token5
        TextEditLine:
            text: 'Text'
            id: text5

<CustomizableEditor@BoxContainer>:
    TextEditLine:
        text: 'type'
        id: type
    TextEditLine:
        text: 'name'
        id: name
    TextEditLine:
        text: 'Additional Text'
        id: text
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Boxes'
            id: boxes1
        TextEditLine:
            text: 'Name'
            id: name1
    TextEditArea:
        text: 'Text'
        id: text1
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Boxes'
            id: boxes2
        TextEditLine:
            text: 'Name'
            id: name2
    TextEditArea:
        text: 'Text'
        id: text2
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Boxes'
            id: boxes3
        TextEditLine:
            text: 'Name'
            id: name3
    TextEditArea:
        text: 'Text'
        id: text3
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Boxes'
            id: boxes4
        TextEditLine:
            text: 'Name'
            id: name4
    TextEditArea:
        text: 'Text'
        id: text4
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Boxes'
            id: boxes5
        TextEditLine:
            text: 'Name'
            id: name5
    TextEditArea:
        text: 'Text'
        id: text5
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Boxes'
            id: boxes6
        TextEditLine:
            text: 'Name'
            id: name6
    TextEditArea:
        text: 'Text'
        id: text6
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Boxes'
            id: boxes7
        TextEditLine:
            text: 'Name'
            id: name7
    TextEditArea:
        text: 'Text'
        id: text7
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Boxes'
            id: boxes8
        TextEditLine:
            text: 'Name'
            id: name8
    TextEditArea:
        text: 'Text'
        id: text8
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Boxes'
            id: boxes9
        TextEditLine:
            text: 'Name'
            id: name9
    TextEditArea:
        text: 'Text'
        id: text9
    BoxLayout:
        size_hint_y: None
        height: self.minimum_height
        orientation: "horizontal"
        TextEditLine:
            text: 'Boxes'
            id: boxes10
        TextEditLine:
            text: 'Name'
            id: name10
    TextEditArea:
        text: 'Text'
        id: text10

<StoryEditor@BoxContainer>:
    TextEditLine:
        text: 'Type'
        id: type
    TextEditLine:
        text: 'Name'
        id: name
    TextEditLine:
        text: 'Text'
        id: text
    TextEditLine:
        text: 'Class'
        id: classes
